Procedure	sql_mode
Create Procedure	character_set_client	collation_connection	Database Collation
keyword_search
CREATE DEFINER=`neuromldb2`@`localhost`
PROCEDURE `keyword_search`(IN keywords_list varchar(100),IN keywords_cnt integer)\nbegin\nDECLARE Kword varchar(25);\nDECLARE  it INT DEFAULT 1;\nTRUNCATE table temp_query_results;\nTRUNCATE table out_query_results;\nWHILE keywords_cnt != 0 AND keywords_list IS NOT NULL DO\nSELECT substring_index(keywords_list,' ',it) into Kword;\n\nSELECT REPLACE(keywords_list,Kword,'') INTO keywords_list;\nSELECT REPLACE(Kword,' ','') INTO Kword;\nSELECT CONCAT('%',Kword,'%') into Kword;\n\n\n\nTRUNCATE table temp_query_results;\nINSERT INTO temp_query_results (SELECT distinct(Model_ID) FROM keyword_view WHERE Keywords LIKE Kword);\n\n\n\n\nTRUNCATE table query_results;\nINSERT INTO query_results SELECT temp_query_results.model_ID FROM temp_query_results\nUNION\nSELECT distinct(partof_tables.Child) AS model_ID FROM partof_tables, temp_query_results WHERE temp_query_results.Model_ID = partof_tables.parent\nUNION\nSELECT distinct(partof_tables.parent) AS model_ID FROM partof_tables, temp_query_results WHERE temp_query_results.Model_ID = partof_tables.child;\n\n\n\nIF it = 1 THEN \nTRUNCATE table out_query_results;\nINSERT INTO out_query_results SELECT distinct(a.Model_ID) FROM query_results a;\n\n\nELSE\nTRUNCATE table temp_query_results;\nINSERT INTO temp_query_results(SELECT a.Model_ID FROM out_query_results a);\nTRUNCATE TABLE out_query_results;\nINSERT INTO out_query_results SELECT a.Model_ID FROM temp_query_results a INNER JOIN query_results USING (Model_ID);\nEND IF;\n\nSET keywords_cnt = keywords_cnt-1;\nSET it = it+1;\n\nEND WHILE;                                                  \nSELECT * FROM out_query_results ORDER BY Model_ID desc;\n\nend	utf8	utf8_general_ci	latin1_swedish_ci
